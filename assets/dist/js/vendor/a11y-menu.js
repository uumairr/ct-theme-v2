"use strict";var _createClass=function(){function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Navigation=function(){function n(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=e.menuId,t=void 0===t?"am-main-menu":t,e=e.click,e=void 0!==e&&e;_classCallCheck(this,n),this.menu=null,this.menuId=t,this.click=e,this.currentItem=null}return _createClass(n,[{key:"removeNoJs",value:function(){Array.from(this.menu.querySelectorAll(".no-js")).map(function(e){return e.classList.remove("no-js")})}},{key:"getCurrentTopLevelItem",value:function(e){if(null!==e)return e.closest("#"+this.menuId+" > li")}},{key:"toggleCurrentTopLevelItemClass",value:function(t){return Array.from(document.querySelectorAll("#"+this.menuId+" > li")).map(function(e){if(e.classList.remove("am-current-item"),e.contains(t))return e.classList.add("am-current-item"),e}).filter(function(e){if(void 0!==e)return e})[0]}},{key:"manageSubmenuState",value:function(s){Array.from(this.menu.querySelectorAll(".am-submenu-toggle")).map(function(e){var t=e.parentElement.parentElement.previousElementSibling,n=e.nextElementSibling,a="am-submenu-list-open",i=e.isSameNode(s),r=e.getAttribute("aria-expanded"),l=void 0;n&&(i&&"false"===r&&t?(l=t.nextElementSibling,t.setAttribute("aria-expanded","true"),e.setAttribute("aria-expanded","true"),l.classList.add(a),n.classList.add(a)):i&&"true"===r&&t?(l=t.nextElementSibling,t.setAttribute("aria-expanded","true"),e.setAttribute("aria-expanded","false"),l.classList.add(a),n.classList.remove(a)):i&&"false"===r?(e.setAttribute("aria-expanded","true"),n.classList.add(a)):(e.setAttribute("aria-expanded","false"),n.classList.remove(a)))})}},{key:"clearSubmenuClass",value:function(e){var t=Array.from(document.querySelectorAll(".am-submenu-list-open"));e.closest(".am-submenu-toggle")||t.map(function(e){return e.classList.remove("am-submenu-list-open")})}},{key:"clearAllAriaExpanded",value:function(e){var t=Array.from(document.querySelectorAll(".am-submenu-toggle"));e.closest(".am-submenu-toggle")||t.map(function(e){return e.setAttribute("aria-expanded","false")})}},{key:"clearAll",value:function(e){e=e.target;this.clearSubmenuClass(e),this.clearAllAriaExpanded(e),document.removeEventListener("click",this.clearAll.bind(this)),document.removeEventListener("keydown",this.clearAll.bind(this))}},{key:"setMenuEventListeners",value:function(){var t=this,e=["keydown"];this.click&&(e.push("click"),[].slice.call(this.menu.querySelectorAll(".am-submenu-list")).forEach(function(e){return e.classList.add("am-click-menu")}));for(var n=0;n<e.length;n++)this.menu.addEventListener(e[n],function(e){t.eventDispatcher(e)})}},{key:"setDocumentEventListeners",value:function(e){var t=this;"true"===e.getAttribute("aria-expanded")&&(this.clearAll=this.clearAll.bind(this),document.addEventListener("click",this.clearAll),document.addEventListener("keydown",function(e){27===e.which&&t.clearAll({target:document.body})}))}},{key:"eventDispatcher",value:function(e){"click"===e.type&&this.clickHandler(e)}},{key:"clickHandler",value:function(e){e=e.target;"button"===e.localName&&(this.toggleCurrentTopLevelItemClass(e),this.manageSubmenuState(e),this.setDocumentEventListeners(e))}},{key:"init",value:function(){this.menu=document.getElementById(this.menuId),this.removeNoJs(),this.setMenuEventListeners()}}]),n}(),menuOpts={menuId:"primary-menu",click:!0},navigation=new Navigation(menuOpts);document.addEventListener("DOMContentLoaded",function(){navigation.init()});